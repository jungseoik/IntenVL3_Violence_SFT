{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Debug InternVL2 Finetune",
      "type": "python",
      "request": "launch",
      "program": "internvl_chat/internvl/train/internvl_chat_finetune.py",
      "args": [
        "--model_name_or_path", "/home/piawsa6000/work/seoik/HolmesVAU/IntenVL3_Violence_SFT/ckpts/InternVL3-2B",
        "--conv_style", "internvl2_5",
        "--output_dir", "/home/piawsa6000/work/seoik/HolmesVAU/IntenVL3_Violence_SFT/ckpts/fucking_lora",
        "--meta_path", "/home/piawsa6000/work/seoik/HolmesVAU/IntenVL3_Violence_SFT/internvl_chat/shell/data/custom_data.json",
        "--overwrite_output_dir", "True",
        "--force_image_size", "448",
        "--max_dynamic_patch", "6",
        "--down_sample_ratio", "0.5",
        "--drop_path_rate", "0.0",
        "--freeze_llm", "True",
        "--freeze_mlp", "True",
        "--freeze_backbone", "True",
        "--use_llm_lora", "64",
        "--vision_select_layer", "-1",
        "--dataloader_num_workers", "4",
        "--bf16", "True",
        "--num_train_epochs", "1",
        "--per_device_train_batch_size", "2",
        "--gradient_accumulation_steps", "128",
        "--evaluation_strategy", "no",
        "--save_strategy", "steps",
        "--save_steps", "200",
        "--save_total_limit", "1",
        "--learning_rate", "4e-5",
        "--weight_decay", "0.01",
        "--warmup_ratio", "0.03",
        "--lr_scheduler_type", "cosine",
        "--logging_steps", "1",
        "--max_seq_length", "4096",
        "--do_train", "True",
        "--grad_checkpoint", "True",
        "--group_by_length", "True",
        "--dynamic_image_size", "True",
        "--use_thumbnail", "True",
        "--ps_version", "v2",
        "--deepspeed", "${workspaceFolder}/internvl_chat/zero_stage1_config.json",
        "--report_to", "tensorboard"
      ],
      "env": {
      "PYTHONPATH": "${workspaceFolder}/internvl_chat",
      "TF_CPP_MIN_LOG_LEVEL": "3",
      "MASTER_PORT": "34229",
      "LAUNCHER": "pytorch",
      "RANK": "0",
      "LOCAL_RANK": "0",
      "WORLD_SIZE": "1",
      "CUDA_VISIBLE_DEVICES": "0,1",
      "PER_DEVICE_BATCH_SIZE": "1",
      "DEBUG_MODE": "1",
      "MASTER_ADDR": "127.0.0.1",
      "MASTER_PORT": "34229",
      "CUDA_HOME": "/usr/local/cuda-12.3",
      "PATH": "/usr/local/cuda-12.3/bin:${env:PATH}",
      "LD_LIBRARY_PATH": "/usr/local/cuda-12.3/lib64:${env:LD_LIBRARY_PATH}"
    },
      "python": "${command:python.interpreterPath}",
      "console": "integratedTerminal"
    }
  ]
}
